<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Facebook Link Extractor</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
      }
      input.link-box {
        width: 80%;
        margin: 5px 0;
        padding: 5px;
      }
      button.copy-btn {
        margin-left: 5px;
        cursor: pointer;
      }
      section {
        margin-bottom: 40px;
      }
    </style>
  </head>
  <body>
    <h1>Facebook Link Extractor</h1>

    <section>
      <h2>‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå 1: ‡∏î‡∏∂‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å Clickbase</h2>
      <input id="urlInput1" type="text" size="80" value="" />
      <button onclick="extractAttribLinks()">‡∏î‡∏∂‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå attributionsrc</button>
      <div id="output1"></div>
    </section>

    <section>
      <h2>‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå 2: ‡∏î‡∏∂‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡πÇ‡∏û‡∏™‡∏ï‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏á hashtag</h2>
      <h3>‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ö‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå ‡∏à‡∏∞‡∏´‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ï‡πâ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå</h3>
      <input id="urlInput2" type="text" size="80" value="" />
      <button onclick="extractPostLinks()">‡∏î‡∏∂‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏û‡∏™‡∏ï‡πå</button>
      <div id="output2"></div>
    </section>

    <script>
      async function extractAttribLinks() {
        const url = document.getElementById('urlInput1').value;
        const output = document.getElementById('output1');
        output.innerHTML = '<p>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>';

        try {
          const response = await fetch('/extract?url=' + encodeURIComponent(url));
          if (!response.ok) throw new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');

          const data = await response.json();

          if (data.links.length === 0) {
            output.innerHTML = '<p>‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ attributionsrc ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô l.php</p>';
          } else {
            let html = "<p>‚úÖ ‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ attributionsrc ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå l.php (‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥):</p>";
            data.links.forEach((link, index) => {
              const safeId = 'link_' + index;
              html += `
                <div>
                  <input type="text" id="${safeId}" class="link-box" value="${link.href}" readonly />
                  <button class="copy-btn" onclick="copyToClipboard('${safeId}')">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                </div>
              `;
            });
            output.innerHTML = html;
          }
        } catch (err) {
          output.innerHTML = '<p>‚ùå ' + err.message + '</p>';
        }
      }

      async function extractPostLinks() {
        const url = document.getElementById('urlInput2').value;
        const output = document.getElementById('output2');
        output.innerHTML = '<p>‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>';

        try {
          const response = await fetch('/extract-post-links?url=' + encodeURIComponent(url));
          if (!response.ok) throw new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');

          const data = await response.json();

          if (data.links.length === 0) {
            output.innerHTML = '<p>‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå</p>';
          } else {
            let html = "<p>‚úÖ ‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡πÇ‡∏û‡∏™‡∏ï‡πå (‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà hashtag):</p>";
            data.links.forEach((link, index) => {
              const safeId = 'postlink_' + index;
              html += `
                <div>
                  <input type="text" id="${safeId}" class="link-box" value="${link.href}" readonly />
                  <button class="copy-btn" onclick="copyToClipboard('${safeId}')">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                </div>
              `;
            });
            output.innerHTML = html;
          }
        } catch (err) {
          output.innerHTML = '<p>‚ùå ' + err.message + '</p>';
        }
      }

      function copyToClipboard(id) {
        const input = document.getElementById(id);
        input.select();
        input.setSelectionRange(0, 99999);
        document.execCommand('copy');
        alert('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: ' + input.value);
      }
    </script>
  </body>
</html>
